<div *ngIf="store.data$()"
     class="data-table-page">
  <div class="data-table-page__main-container">
    <mix-sub-toolbar *ngIf="store.state() as state"
                     [description]="'LISTING'"
                     [title]="'All Database'">
      <div class="toolbar-separator"></div>
      <mix-button (click)="createDatabase()"
                  size="s"><span class="material-symbols-outlined"> add </span>&nbsp; Add New
        Database</mix-button>
      <div class="toolbar-separator"></div>
      <mix-button class="mr-1"
                  type="secondary-danger"
                  [disabled]="!selectedPages.length"
                  size="s">
        <span class="material-symbols-outlined"> delete </span>&nbsp; Delete
        Database(s)</mix-button>
    </mix-sub-toolbar>

    <div *ngIf="store.state$ | async as state"
         class="data-table-page__body">
      <mix-data-table [dataset]="state.data"
                      [loading]="state.status === 'Loading'"
                      [pageInfo]="state.pageInfo"
                      [searchFieldOptions]="['displayName']"
                      (itemsSelectedChange)="selectedPages = $event || []"
                      (pageChange)="store.changePage($event)"
                      (searchChange)="
          store.searchChange($event.searchText, $event.searchField)
        ">
        <div [columnType]="'CHECKBOX'"
             mixTableColumn></div>

        <div [header]="'Name'"
             [minWidth]="'150px'"
             key="displayName"
             mixTableColumn>
          <ng-template let-data
                       mixColumnCell>
            <div class="text-600"
                 (click)="goDetail(data.id)">
              {{ data.displayName }}
            </div>
          </ng-template>
        </div>

        <div [header]="'System Name'"
             key="systemName"
             mixTableColumn>
          <ng-template let-data
                       mixColumnCell>
            <div (click)="goDetail(data.id)">{{ data.systemName }}</div>
          </ng-template>
        </div>

        <div [header]="'Created'"
             key="createdDateTime"
             mixTableColumn>
          <ng-template let-data
                       mixColumnCell>
            <div>
              {{ data.createdDateTime | date: 'short' | relativeTimeSpan }}
            </div>
          </ng-template>
        </div>

        <div [header]="'Author'"
             key="modifiedBy"
             mixTableColumn></div>

        <div [header]="'Status'"
             key="status"
             mixTableColumn>
          <ng-template let-data
                       mixColumnCell>
            <mix-status-indicator [status]="data.status"></mix-status-indicator>
          </ng-template>
        </div>

        <div [columnType]="'ACTION'"
             [header]="''"
             [sortable]="false"
             key="action"
             mixTableColumn>
          <ng-template let-data
                       mixColumnCell>
            <mix-button (click)="goDetail(data.id)"
                        size="s"><span class="material-symbols-outlined">
                construction
              </span></mix-button>

            <mix-button class="ms-2"
                        (click)="goDatabaseData(data.systemName)"
                        size="s"><span class="material-symbols-outlined">
                database
              </span></mix-button>
          </ng-template>
        </div>
      </mix-data-table>
    </div>
  </div>
</div>
