<div class="entity-form"
     [class.--new]="entity.new"
     [formGroup]="form">
  <div class="row">
    <div class="col-4 d-flex align-items-center gap-2">
      <span class="mix-icon">drag_indicator</span>

      <mix-input [size]="'s'"
                 placeHolder="Display name"
                 formControlName="displayName"></mix-input>
    </div>

    <div class="col-4">
      <div class="d-flex gap-1">
        <mix-button type="outline"
                    [iconBtn]="true"
                    (click)="updateSystemName()"
                    size="s"><span class="mix-icon">refresh</span></mix-button>
        <mix-input [closable]="false"
                   [size]="'s'"
                   placeHolder="Unique system name"
                   formControlName="systemName"></mix-input>
      </div>
    </div>

    <div class="col-2">
      <mix-button class="w-100 data-type-select"
                  type="outline"
                  (click)="showDataTypeDialog($event, dataTypePicker)"
                  size="s">
        <div>
          {{ form.controls.dataType.value }}
        </div>

        <span class="mix-icon">chevron_right</span>
      </mix-button>
    </div>
  </div>

  <div class="entity-form__action">
    <mix-button [iconBtn]="true"
                (click)="showDialog(template)"
                size="s"><span class="material-symbols-outlined"> settings </span></mix-button>

    <mix-button type="outline"
                [iconBtn]="true"
                (click)="deleteEntity.emit(entity)"
                size="s"><span class="material-symbols-outlined"> delete </span></mix-button>
  </div>
</div>

<ng-template #template
             let-observer>
  <nav [(activeItemIndex)]="activeTabIndex"
       tuiTabs>
    <button tuiTab>
      <span class="material-symbols-outlined"> feed </span>&nbsp; General
    </button>
    <button tuiTab>
      <span class="material-symbols-outlined"> settings </span>&nbsp; Default
      Value
    </button>
  </nav>

  <div class="mt-8"
       [formGroup]="configurationForm">
    <ng-container *ngIf="activeTabIndex === 0">
      <mix-toggle class="mt-2"
                  formControlName="isEncrypt">
        Encrypt this field</mix-toggle>
      <mix-toggle class="mt-2"
                  formControlName="isRequire">
        Mark this field as required</mix-toggle>
    </ng-container>
  </div>
</ng-template>

<ng-template #dataTypePicker
             let-observer>
  <div class="data-type-picker-dialog-container">
    <div class="row"
         [formGroup]="form">
      <div *ngFor="let dataType of dataTypes"
           class="col-12 col-md-6">
        <tui-radio-block class="mb-2 data-type-card"
                         [item]="dataType"
                         formControlName="dataType"
                         contentAlign="left"
                         size="l">
          <div class="inner">
            {{ $any(dataTypeDisplay)[dataType].name }}

            <div class="text-sub text-s">
              Lorem ipsum dolor sit amet, consectetur adipisicing elit?
            </div>
          </div>
        </tui-radio-block>
      </div>
    </div>
  </div>
</ng-template>
